# local basemaps

This repo represents a proof-of-concept for serving up vector map tiles locally with the PMTiles format. I'm making use of [MapLibre's Martin server](https://github.com/maplibre/martin) via a Docker container to serve a static PMTiles basemap. I'm also trying this out just server the pmtiles as a static file and querying it with the MapLibre pmtiles provider.

The basemap is generated by running `pmtiles extract` against a recent build of [Protomap's hosted global vector basemap](https://maps.protomaps.com/builds/). For this proof of concept I'm just loading the NYC region, all the way up to zoom 15.

## Requirements

To generate the data and run the tile server, you'll need a build of the [pmtiles cli](https://github.com/protomaps/go-pmtiles/releases), and Docker installed.

To run the front-end, you'll need a working [NodeJS](https://nodejs.org/) installation.

## Running vector tile server

To download basemap data and run a Docker image, simply run:

```console
make docker-run
```

Vector tiles should now be available at http://localhost:3000/nyc/{z}/{x}/{y}.pbf

## Running front end 

Included in this repo is a basic TypeScript + Vite project with a simple [MapLibre implementation](https://maplibre.org/).

It can either load vector data from the locally running Martin server and renders them with [Protomaps' basemap theme](https://docs.protomaps.com/basemaps/maplibre). 

Or it can load it straight from the static pmtiles file, using the [MapLibre pmtiles provider](https://maplibre.org/maplibre-gl-js-docs/api/providers/#pmtilesprovider).

First, install the dependencies with:

```
npm install
```

Then, kick off a development server with:

```
npm run dev
```

You should be able to see the map rendering at [http://localhost:5173](http://localhost:5173)

## Next steps

I'm curious about each layer of this, and I'm relying on a lot of helpful work from Protomaps at the moment. Specifically I'd like to try:

- [ ] A custom basemap theme, likely using the [Protomaps package](https://github.com/protomaps/basemaps/tree/main/styles) as a starting point
- [ ] Generating and hosting my own font glyphs, rather than relying on Protomaps' hosted fonts. Here there is more to learn from the [Protomaps examples](https://github.com/protomaps/basemaps-assets) again
